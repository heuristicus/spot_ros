<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Basic Driver Usage &mdash; Spot ROS User Documentation 1.0.0 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Arm control" href="arm_usage.html" />
    <link rel="prev" title="Driver configuration" href="driver_configuration.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Spot ROS User Documentation
          </a>
              <div class="version">
                1.0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="robot_setup.html">Robot Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="ros_setup.html">Computer Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="driver_configuration.html">Driver configuration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Basic Driver Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#verify-the-urdf">Verify the URDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configure-your-networking">Configure your networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-the-driver">Running the driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="#view-the-robot">View the robot</a></li>
<li class="toctree-l2"><a class="reference internal" href="#taking-control-of-the-robot">Taking control of the robot</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#holding-the-lease">Holding the lease</a></li>
<li class="toctree-l3"><a class="reference internal" href="#emergency-stops">Emergency stops</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enable-motor-power">Enable motor power</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stand-the-robot-up">Stand the robot up</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#controlling-the-velocity">Controlling the velocity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#topic">Topic</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#controlling-the-body">Controlling the body</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#static-body-pose">Static body pose</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#service">Service</a></li>
<li class="toctree-l4"><a class="reference internal" href="#actionserver">Actionserver</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rviz">Rviz</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#in-motion-body-pose">In-motion body pose</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Topic</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Actionserver</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#moving-to-a-pose">Moving to a pose</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ros-topic">ROS Topic</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">Actionserver</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">Rviz</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#setting-velocity-limits">Setting velocity limits</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cameras-and-depth-clouds">Cameras and Depth Clouds</a></li>
<li class="toctree-l2"><a class="reference internal" href="#self-righting-and-roll-over">Self righting and roll over</a></li>
<li class="toctree-l2"><a class="reference internal" href="#autonomous-docking">Autonomous docking</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#services">Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">Actionserver</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">Rviz</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#advanced-motion-control">Advanced motion control</a></li>
<li class="toctree-l2"><a class="reference internal" href="#monitoring">Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="arm_usage.html">Arm control</a></li>
<li class="toctree-l1"><a class="reference internal" href="cam_usage.html">Spot CAM</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Spot ROS User Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Basic Driver Usage</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/ros_usage.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="basic-driver-usage">
<h1>Basic Driver Usage<a class="headerlink" href="#basic-driver-usage" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Before doing anything with the robot, you should read the Boston Dynamics <a class="reference external" href="https://d3cjkvgbik1jtv.cloudfront.net/Spot%20IFU/spot_information_for_use_EN_v1.1.pdf">safety guidelines</a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Details of how the robot functions can be found in the <a class="reference external" href="https://dev.bostondynamics.com">Boston Dynamics SDK documentation</a>.</p>
</div>
<div class="section" id="verify-the-urdf">
<h2>Verify the URDF<a class="headerlink" href="#verify-the-urdf" title="Permalink to this headline">¶</a></h2>
<p>To verify that the spot_viz and spot_description packages are sourced properly, you can run</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">roslaunch</span> <span class="n">spot_viz</span> <span class="n">view_model</span><span class="o">.</span><span class="n">launch</span>
</pre></div>
</div>
<p>This will load RVIZ with the robot description visible.  It should also show any additions you may have added to the robot’s URDF</p>
<img alt="_images/view_model.png" src="_images/view_model.png" />
</div>
<div class="section" id="configure-your-networking">
<h2>Configure your networking<a class="headerlink" href="#configure-your-networking" title="Permalink to this headline">¶</a></h2>
<p>If your ROS machine is attached to a payload port you will need to configure it so that it can connect to spot. See <a class="reference external" href="https://support.bostondynamics.com/s/article/Payload-device-network-configuration">payload network configuration</a> for more details.</p>
</div>
<div class="section" id="running-the-driver">
<h2>Running the driver<a class="headerlink" href="#running-the-driver" title="Permalink to this headline">¶</a></h2>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">roslaunch</span> <span class="n">spot_driver</span> <span class="n">driver</span><span class="o">.</span><span class="n">launch</span>
</pre></div>
</div>
<p>When launching, there are some options you may need to configure for your setup:</p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="14%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Argument</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>username</td>
<td>dummyusername</td>
<td>Use this username to authenticate with spot</td>
</tr>
<tr class="row-odd"><td>password</td>
<td>dummypassword</td>
<td>Use this password to authenticate with spot</td>
</tr>
<tr class="row-even"><td>hostname</td>
<td>192.168.50.3</td>
<td>The IP address at which spot can be found</td>
</tr>
<tr class="row-odd"><td>estop_timeout</td>
<td>9.0</td>
<td>Time allowed before rpc commands will time out. Comms between the
robot and driver are checked at a rate of 1/3 of this time. If
comms are down, a gentle estop will trigger</td>
</tr>
<tr class="row-even"><td>autonomy_enabled</td>
<td>True</td>
<td>If false, some autonomy commands will be disabled for this run of
the driver. This can only be changed on driver restart</td>
</tr>
<tr class="row-odd"><td>max_linear_velocity_x</td>
<td>0</td>
<td>Limit on linear velocity for moving forwards. 0 is whatever is
specified by BD.</td>
</tr>
<tr class="row-even"><td>max_linear_velocity_y</td>
<td>0</td>
<td>Limit on linear velocity for moving sideways. 0 is whatever is
specified by BD.</td>
</tr>
<tr class="row-odd"><td>max_linear_velocity_z</td>
<td>0</td>
<td>Limit on angular velocity for rotation. 0 is whatever is specified
by BD.</td>
</tr>
<tr class="row-even"><td>allow_motion</td>
<td>True</td>
<td>If false, the robot starts with all motion disallowed and must have
it enabled by calling a service or pressing a button in rviz</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="view-the-robot">
<h2>View the robot<a class="headerlink" href="#view-the-robot" title="Permalink to this headline">¶</a></h2>
<p>Once the robot is connected, you should be able to visualize its odometry, joint positions, camera streams, etc.
using rviz.  To view these streams, run</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">roslaunch</span> <span class="n">spot_viz</span> <span class="n">view_robot</span><span class="o">.</span><span class="n">launch</span>
</pre></div>
</div>
<p>Once RVIZ is loaded, you should see something similar to this.</p>
<img alt="_images/view_robot.png" src="_images/view_robot.png" />
</div>
<div class="section" id="taking-control-of-the-robot">
<h2>Taking control of the robot<a class="headerlink" href="#taking-control-of-the-robot" title="Permalink to this headline">¶</a></h2>
<p>The easiest way to control the robot is through the rviz control panel, which connects to the various ROS services.
Many commands which can be executed using a service or topic can also be executed using the panel. To add the panel
to rviz go to Panels&gt;Add new panel and the select <code class="docutils literal notranslate"><span class="pre">SpotControlPanel</span></code> under <code class="docutils literal notranslate"><span class="pre">spot_viz</span></code>. It is included by default
in the <code class="docutils literal notranslate"><span class="pre">view_robot</span></code> launch file.</p>
<img alt="_images/rviz_panel.png" src="_images/rviz_panel.png" />
<div class="section" id="holding-the-lease">
<h3>Holding the lease<a class="headerlink" href="#holding-the-lease" title="Permalink to this headline">¶</a></h3>
<p>A body lease gives the holder the ability to command the spot to make actions in the world.</p>
<p>There are two ways to claim a body lease and eStop using this driver.</p>
<ol class="arabic simple">
<li>Automatically when the driver starts by enabling the <code class="docutils literal notranslate"><span class="pre">auto_claim</span></code> variable</li>
<li>By calling the <code class="docutils literal notranslate"><span class="pre">/spot/claim</span></code> service after the driver is started</li>
</ol>
<p>You cannot claim a lease on the robot if something else already has a lease. This is for security and safety reasons.
Check the``status/leases`` topic for information on current leases.</p>
<p>You can release the lease by calling the <code class="docutils literal notranslate"><span class="pre">/spot/release</span></code> service.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Releasing the lease while the robot is standing will trigger a gentle estop.</p>
</div>
<p>Holding a lease automatically establishes an estop connection to the robot.</p>
<p>All buttons except the claim lease button on the rviz panel are disabled if the ROS driver does not hold the lease.</p>
</div>
<div class="section" id="emergency-stops">
<h3>Emergency stops<a class="headerlink" href="#emergency-stops" title="Permalink to this headline">¶</a></h3>
<p>The estop connection gives the robot a way to guarantee that the commanding system is maintaining contact with the
robot. If this contact is lost, the robot will perform a gentle stop. The gentle and hard estops are calling through
to the BD SDK.</p>
<p>The gentle stop is at <code class="docutils literal notranslate"><span class="pre">/spot/estop/gentle</span></code>. It stops all motion of the robot and commands it to sit. This stop does
not have to be released.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The hard estop immediately cuts power to the motors. The robot may collapse in an uncontrolled manner.</p>
</div>
<p>The hard estop is at <code class="docutils literal notranslate"><span class="pre">/spot/estop/hard</span></code> this will kill power to the motors and must be released before you can send
any commands to the robot. To release the estop, call <code class="docutils literal notranslate"><span class="pre">/spot/estop/release</span></code>.</p>
<p>There is an additional service <code class="docutils literal notranslate"><span class="pre">/spot/stop</span></code> which is implemented by the driver. This service stops any command that
is currently being executed. The <code class="docutils literal notranslate"><span class="pre">/spot/locked_stop</span></code> stops the current command and also disallows any further motion
of the robot. Motion can be allowed again by calling the <code class="docutils literal notranslate"><span class="pre">/spot/allow_motion</span></code> service.</p>
<p>The top of the rviz panel has buttons to control the estops as described above, and also displays their status. It
also shows whether the robot is allowed to move or not.</p>
<img alt="_images/rviz_estops.png" src="_images/rviz_estops.png" />
</div>
<div class="section" id="enable-motor-power">
<h3>Enable motor power<a class="headerlink" href="#enable-motor-power" title="Permalink to this headline">¶</a></h3>
<p>Motor power needs to be enabled once you have a Lease on the body.  This can be done in two ways:</p>
<ol class="arabic simple">
<li>Automatically when the driver starts by enabling the <code class="docutils literal notranslate"><span class="pre">auto_power_on</span></code> variable</li>
<li>By calling the <code class="docutils literal notranslate"><span class="pre">/spot/power_on</span></code> service after the driver is started</li>
</ol>
</div>
<div class="section" id="stand-the-robot-up">
<h3>Stand the robot up<a class="headerlink" href="#stand-the-robot-up" title="Permalink to this headline">¶</a></h3>
<p>Once the motors are powered, stand the robot up so it is able to move through the world.  This can be done in two ways:</p>
<ol class="arabic simple">
<li>Automatically when the driver starts by enabling the <code class="docutils literal notranslate"><span class="pre">auto_stand</span></code> variable</li>
<li>By calling the <code class="docutils literal notranslate"><span class="pre">/spot/stand</span></code> service after the driver is started</li>
</ol>
</div>
</div>
<div class="section" id="controlling-the-velocity">
<h2>Controlling the velocity<a class="headerlink" href="#controlling-the-velocity" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Spot will attempt to avoid any obstacles it detects with its cameras, but no vision or actuation system is perfect.  Make sure to only move the robot in a safe area and in a controlled manner.</p>
</div>
<div class="section" id="topic">
<h3>Topic<a class="headerlink" href="#topic" title="Permalink to this headline">¶</a></h3>
<p>To control Spot, you can send a Twist message to command a velocity.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rostopic</span> <span class="n">pub</span> <span class="o">/</span><span class="n">spot</span><span class="o">/</span><span class="n">cmd_vel</span> <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Twist</span> <span class="s2">&quot;linear:</span>
  <span class="n">x</span><span class="p">:</span> <span class="mf">0.0</span>
  <span class="n">y</span><span class="p">:</span> <span class="mf">0.0</span>
  <span class="n">z</span><span class="p">:</span> <span class="mf">0.0</span>
<span class="n">angular</span><span class="p">:</span>
  <span class="n">x</span><span class="p">:</span> <span class="mf">0.0</span>
  <span class="n">y</span><span class="p">:</span> <span class="mf">0.0</span>
  <span class="n">z</span><span class="p">:</span> <span class="mf">0.3</span><span class="s2">&quot; -r 10</span>
</pre></div>
</div>
<p>That command will have spot rotate on the spot at 0.3 radians/second.  Note the -r at the end of the command.  That has ROS resend the message over again.  If you don’t resend the message, the driver will assume a timeout and stop commanding motion of the robot.</p>
</div>
</div>
<div class="section" id="controlling-the-body">
<h2>Controlling the body<a class="headerlink" href="#controlling-the-body" title="Permalink to this headline">¶</a></h2>
<p>There are two different ways of specifying the pose of the body.</p>
<div class="section" id="static-body-pose">
<h3>Static body pose<a class="headerlink" href="#static-body-pose" title="Permalink to this headline">¶</a></h3>
<p>The static body pose changes the body position only when the robot is stationary. Any other motion will reset the
body to its normal pose. It can adjust the roll, pitch, yaw, and body height.</p>
<div class="section" id="service">
<h4>Service<a class="headerlink" href="#service" title="Permalink to this headline">¶</a></h4>
<p>The body can be posed by a service call to <code class="docutils literal notranslate"><span class="pre">/spot/posed_stand</span></code>.</p>
<p>If using a pose message, you can control the body height by setting the z component of position. The x and y
components of position are ignored. If the pose message is non-zero, any roll/pitch/yaw specification will be ignored.</p>
<p>If using the roll/pitch/yaw specification, enter values in degrees, and body height in metres. Body height is based
on displacement from the neutral position.</p>
<p>If you send an empty message, the body pose will be reset to neutral.</p>
</div>
<div class="section" id="actionserver">
<h4>Actionserver<a class="headerlink" href="#actionserver" title="Permalink to this headline">¶</a></h4>
<p>The actionserver <code class="docutils literal notranslate"><span class="pre">/spot/body_pose</span></code> can be called to set the body pose.</p>
<p>To test this, start an action client with</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rosrun</span> <span class="n">actionlib_tools</span> <span class="n">axclient</span><span class="o">.</span><span class="n">py</span> <span class="o">/</span><span class="n">spot</span><span class="o">/</span><span class="n">body_pose</span>
</pre></div>
</div>
<p>You will see a window pop up, and you can specify the body pose with a Pose message, or by specifying roll, pitch and
yaw, and a body height.</p>
<p>Here is what the axclient window will look like:</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">body_pose</span><span class="p">:</span>
  <span class="n">position</span><span class="p">:</span>
    <span class="n">x</span><span class="p">:</span> <span class="mf">0.0</span>
    <span class="n">y</span><span class="p">:</span> <span class="mf">0.0</span>
    <span class="n">z</span><span class="p">:</span> <span class="mf">0.0</span>
  <span class="n">orientation</span><span class="p">:</span>
    <span class="n">x</span><span class="p">:</span> <span class="mf">0.0</span>
    <span class="n">y</span><span class="p">:</span> <span class="mf">0.0</span>
    <span class="n">z</span><span class="p">:</span> <span class="mf">0.0</span>
    <span class="n">w</span><span class="p">:</span> <span class="mf">0.0</span>
<span class="n">roll</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">pitch</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">yaw</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">body_height</span><span class="p">:</span> <span class="mf">0.0</span>
</pre></div>
</div>
</div>
<div class="section" id="rviz">
<h4>Rviz<a class="headerlink" href="#rviz" title="Permalink to this headline">¶</a></h4>
<p>The static pose can also be controlled in the body tab.</p>
<img alt="_images/rviz_body_tab.png" src="_images/rviz_body_tab.png" />
</div>
</div>
<div class="section" id="in-motion-body-pose">
<h3>In-motion body pose<a class="headerlink" href="#in-motion-body-pose" title="Permalink to this headline">¶</a></h3>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The in-motion body pose can affect the stability of the robot while walking.</p>
</div>
<p>It is also possible to specify a pose the robot should hold while it is in motion. This is a more restricted version
of the static body pose and cannot achieve the same body heights or rotational changes. While idle, all the
parameters specified will be held. The pitch and body height are maintained throughout any walking motion
the robot makes. When the robot stops walking, it will return to the pose specified by all parameters.</p>
<div class="section" id="id1">
<h4>Topic<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>This pose can be set through the <code class="docutils literal notranslate"><span class="pre">/spot/in_motion_or_idle_body_pose</span></code> topic</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rostopic</span> <span class="n">pub</span> <span class="o">/</span><span class="n">spot</span><span class="o">/</span><span class="n">in_motion_or_idle_body_pose</span> <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Pose</span> <span class="s2">&quot;position:</span>
  <span class="n">x</span><span class="p">:</span> <span class="mf">0.0</span>
  <span class="n">y</span><span class="p">:</span> <span class="mf">0.0</span>
  <span class="n">z</span><span class="p">:</span> <span class="mf">0.0</span>
<span class="n">orientation</span><span class="p">:</span>
  <span class="n">x</span><span class="p">:</span> <span class="mf">0.0</span>
  <span class="n">y</span><span class="p">:</span> <span class="mf">0.0</span>
  <span class="n">z</span><span class="p">:</span> <span class="mf">0.0</span>
  <span class="n">w</span><span class="p">:</span> <span class="mf">1.0</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h4>Actionserver<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>The actionserver is found at <code class="docutils literal notranslate"><span class="pre">/spot/motion_or_idle_body_pose</span></code> and has the same parameters as the static pose.</p>
</div>
</div>
</div>
<div class="section" id="moving-to-a-pose">
<h2>Moving to a pose<a class="headerlink" href="#moving-to-a-pose" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Take into account the Boston Dynamics <a class="reference external" href="https://d3cjkvgbik1jtv.cloudfront.net/Spot%20IFU/spot_information_for_use_EN_v1.1.pdf">safety guidelines</a> when moving the robot. The robot will attempt to avoid obstacles but will also walk over any uneven terrain, regardless of what that terrain is made up of. You should operate in a controlled environment.</p>
</div>
<p>One of the most important commands for easily controlling the robot is the trajectory command. This command allows
you to move the robot to a position in space by specifying a pose relative to the robot’s current position. You may
specify a pose in a different frame than the <code class="docutils literal notranslate"><span class="pre">body</span></code> frame and it will be transformed into that frame.</p>
<div class="section" id="ros-topic">
<h3>ROS Topic<a class="headerlink" href="#ros-topic" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">/spot/go_to_pose</span></code> topic can be used to move the robot by specifying a pose.</p>
<p>The following command will move the robot one metre forwards from its current location.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rostopic</span> <span class="n">pub</span> <span class="o">/</span><span class="n">spot</span><span class="o">/</span><span class="n">go_to_pose</span> <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">PoseStamped</span> <span class="s2">&quot;header:</span>
  <span class="n">seq</span><span class="p">:</span> <span class="mi">0</span>
  <span class="n">stamp</span><span class="p">:</span>
    <span class="n">secs</span><span class="p">:</span> <span class="mi">0</span>
    <span class="n">nsecs</span><span class="p">:</span> <span class="mi">0</span>
  <span class="n">frame_id</span><span class="p">:</span> <span class="s1">&#39;body&#39;</span>
<span class="n">pose</span><span class="p">:</span>
  <span class="n">position</span><span class="p">:</span>
    <span class="n">x</span><span class="p">:</span> <span class="mi">1</span>
    <span class="n">y</span><span class="p">:</span> <span class="mf">0.0</span>
    <span class="n">z</span><span class="p">:</span> <span class="mf">0.0</span>
  <span class="n">orientation</span><span class="p">:</span>
    <span class="n">x</span><span class="p">:</span> <span class="mf">0.0</span>
    <span class="n">y</span><span class="p">:</span> <span class="mf">0.0</span>
    <span class="n">z</span><span class="p">:</span> <span class="mf">0.0</span>
    <span class="n">w</span><span class="p">:</span> <span class="mi">1</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h3>Actionserver<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">/spot/trajectory</span></code> actionserver gives you a little more control than the ros topic, and will also give you
information about success or failure.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>If there is an obstacle along the trajectory the robot is trying to move along, it may fail as the trajectory command
is different to the command that is used by the controller. In this case, the actionserver will return success
despite not actually reaching the requested pose.</p>
<p class="last">As of 2021/09/10 the boston dynamics API does not appear to provide
feedback which we can use to return failure when this happens.</p>
</div>
<p>In addition to the pose, you can specify <code class="docutils literal notranslate"><span class="pre">duration</span></code>, which specifies how long the command can run before timing out.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">precise_positioning</span></code> variable can be used to request that the robot move more precisely to the specified pose.
If set to false, the robot will move to “near” the specified pose. It’s not clear what exactly defines being “near”
to the pose, but you should not expect to reach the pose precisely. The robot will end up within ~0.5m of the pose,
and not make much effort to align to the orientation.</p>
<p>You can test the actionserver by using an action client</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rosrun</span> <span class="n">actionlib_tools</span> <span class="n">axclient</span> <span class="o">/</span><span class="n">spot</span><span class="o">/</span><span class="n">trajectory</span>
</pre></div>
</div>
<p>And fill in the values as you like.</p>
</div>
<div class="section" id="id5">
<h3>Rviz<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>You can connect the 2d nav goal tool to publish to the <code class="docutils literal notranslate"><span class="pre">/spot/go_to_pose</span></code> topic. The default rviz config provided with</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">roslaunch</span> <span class="n">spot_viz</span> <span class="n">view_robot</span><span class="o">.</span><span class="n">launch</span>
</pre></div>
</div>
<p>Already has the tool configured, but you can also do this by right clicking the toolbar, selecting tool properties,
then changing the nav goal topic to <code class="docutils literal notranslate"><span class="pre">/spot/go_to_pose</span></code>.</p>
</div>
</div>
<div class="section" id="setting-velocity-limits">
<h2>Setting velocity limits<a class="headerlink" href="#setting-velocity-limits" title="Permalink to this headline">¶</a></h2>
<p>You can set a velocity limit in m/s for the motion to poses using the <code class="docutils literal notranslate"><span class="pre">/spot/velocity_limit</span></code> service:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rosservice</span> <span class="n">call</span> <span class="o">/</span><span class="n">spot</span><span class="o">/</span><span class="n">velocity_limit</span> <span class="s2">&quot;velocity_limit:</span>
  <span class="n">linear</span><span class="p">:</span>
    <span class="n">x</span><span class="p">:</span> <span class="mf">0.0</span>
    <span class="n">y</span><span class="p">:</span> <span class="mf">0.0</span>
    <span class="n">z</span><span class="p">:</span> <span class="mf">0.0</span>
  <span class="n">angular</span><span class="p">:</span>
    <span class="n">x</span><span class="p">:</span> <span class="mf">0.0</span>
    <span class="n">y</span><span class="p">:</span> <span class="mf">0.0</span>
    <span class="n">z</span><span class="p">:</span> <span class="mf">0.0</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>Only the x and y components of linear velocity are considered, and the z component of angular.</p>
<p>You can adjust the velocity limits on startup by setting the max linear/angular velocity params.</p>
<p>You can also set the limits using the rviz panel.</p>
<img alt="_images/rviz_motion_tab.png" src="_images/rviz_motion_tab.png" />
</div>
<div class="section" id="cameras-and-depth-clouds">
<h2>Cameras and Depth Clouds<a class="headerlink" href="#cameras-and-depth-clouds" title="Permalink to this headline">¶</a></h2>
<p>Spot is equipped 5 RGB and depth-sensing cameras: 2 on the front, one on each side, and one in the rear.  All of these
cameras publish at approximately 10Hz.</p>
<p>Note that the front cameras are mounted sideways, so they have a narrower horizontal FoV, but a larger vertical one.
The camera data likewise rotated anticlockwise by 90 degrees.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">frontleft</span></code> camera and depth topics are from the camera physically located on the front-left of the robot.
This camera is pointed to the robot’s right, so the depth cloud will appear in front of the robot’s right shoulder:</p>
<img alt="_images/front-left-depth.png" src="_images/front-left-depth.png" />
<p>Similarly the <code class="docutils literal notranslate"><span class="pre">frontright</span></code> camera and depth topics are from the camera physically located on the front-right of the
robot.  This camera points to the robot’s left, so the depth cloud will appear in front of the robot’s left shoulder:</p>
<img alt="_images/front-right-depth.png" src="_images/front-right-depth.png" />
<p>The complete list of depth and camera topics is below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="28%" />
<col width="24%" />
<col width="48%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Topic</th>
<th class="head">Type</th>
<th class="head">Comments</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>camera/frontleft/camera/image</td>
<td>Image</td>
<td>Data from the front-left camera, which points to the
right. Image is rotated 90 degrees anticlockwise.</td>
</tr>
<tr class="row-odd"><td>camera/frontright/camera/image</td>
<td>Image</td>
<td>Data from the front-right camera, which points to the
left. Image is rotated 90 degrees anticlockwise.</td>
</tr>
<tr class="row-even"><td>camera/left/camera/image</td>
<td>Image</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>camera/right/camera/image</td>
<td>Image</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>camera/back/camera/image</td>
<td>Image</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>depth/frontleft/camera/image</td>
<td>Image</td>
<td>Data from the front-left camera, which points to the
right.</td>
</tr>
<tr class="row-even"><td>depth/frontright/camera/image</td>
<td>Image</td>
<td>Data from the front-right camera, which points to the
left.</td>
</tr>
<tr class="row-odd"><td>depth/left/camera/image</td>
<td>Image</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>depth/right/camera/image</td>
<td>Image</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>depth/back/camera/image</td>
<td>Image</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="self-righting-and-roll-over">
<h2>Self righting and roll over<a class="headerlink" href="#self-righting-and-roll-over" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Self righting and battery charging may or may not take into account payloads configured on the robot. Test with your
configuration before using.</p>
</div>
<p>The self-right command can be accessed through <code class="docutils literal notranslate"><span class="pre">/spot/self_right</span></code>.</p>
<p>The roll over commands can be accessed through the <code class="docutils literal notranslate"><span class="pre">/spot/roll_over_left</span></code> and <code class="docutils literal notranslate"><span class="pre">/spot/roll_over_right</span></code> services.</p>
<p>You can also access these actions through rviz.</p>
<img alt="_images/rviz_floor_tab.png" src="_images/rviz_floor_tab.png" />
</div>
<div class="section" id="autonomous-docking">
<h2>Autonomous docking<a class="headerlink" href="#autonomous-docking" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See Boston Dynamics support for information about <a class="reference external" href="https://support.bostondynamics.com/s/article/Spot-Dock-setup">setting up the dock</a>.</p>
</div>
<p>If using a Spot Enterprise, you will have access to autonomous docking capabilities.</p>
<div class="section" id="services">
<h3>Services<a class="headerlink" href="#services" title="Permalink to this headline">¶</a></h3>
<p>You can trigger undocking with <code class="docutils literal notranslate"><span class="pre">/spot/undock</span></code>.</p>
<p>Docking can be triggered with <code class="docutils literal notranslate"><span class="pre">/spot/dock</span></code>. You must provide the fiducial ID of the dock the robot should dock at.</p>
</div>
<div class="section" id="id6">
<h3>Actionserver<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>Docking can also be performed using a single actionserver at <code class="docutils literal notranslate"><span class="pre">/spot/dock</span></code>. To undock, the <code class="docutils literal notranslate"><span class="pre">undock</span></code> variable should
be set to true. Docking is the default action and requires specification of the fiducial ID in the <code class="docutils literal notranslate"><span class="pre">dock_id</span></code> variable.</p>
</div>
<div class="section" id="id7">
<h3>Rviz<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>You can also perform docking through the dock tab.</p>
<img alt="_images/rviz_dock_tab.png" src="_images/rviz_dock_tab.png" />
</div>
</div>
<div class="section" id="advanced-motion-control">
<h2>Advanced motion control<a class="headerlink" href="#advanced-motion-control" title="Permalink to this headline">¶</a></h2>
<p>There are other parameters that can be used to specify the behaviour of the robot. These allow for more granular
control of specific things. You should read and understand the SDK documentation before using these services to alter
any of these parameters.</p>
<ul class="simple">
<li><a class="reference external" href="https://dev.bostondynamics.com/protos/bosdyn/api/proto_reference.html?highlight=power_state#swingheight">/spot/swing_height</a></li>
<li><a class="reference external" href="https://dev.bostondynamics.com/protos/bosdyn/api/proto_reference.html?highlight=power_state#terrainparams">/spot/terrain_params</a></li>
<li><a class="reference external" href="https://dev.bostondynamics.com/protos/bosdyn/api/proto_reference.html?highlight=mobilityparams#locomotionhint">/spot/locomotion_mode</a></li>
<li><a class="reference external" href="https://dev.bostondynamics.com/protos/bosdyn/api/proto_reference.html?highlight=power_state#obstacleparams">/spot/obstacle_params</a></li>
</ul>
<p>Some of the more advanced motion controls can be accessed through the advanced motion tab.</p>
<img alt="_images/rviz_adv_motion_tab.png" src="_images/rviz_adv_motion_tab.png" />
</div>
<div class="section" id="monitoring">
<h2>Monitoring<a class="headerlink" href="#monitoring" title="Permalink to this headline">¶</a></h2>
<p>There are various topics which output information about the state of the robot:</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="26%" />
<col width="52%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Topic</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>status/metrics</td>
<td>Metrics</td>
<td>General metrics for the system like distance walked</td>
</tr>
<tr class="row-odd"><td>status/leases</td>
<td>LeaseArray</td>
<td>A list of what leases are held on the system</td>
</tr>
<tr class="row-even"><td>odometry/twist</td>
<td>TwistWithCovarianceStamped</td>
<td>The estimated odometry of the platform</td>
</tr>
<tr class="row-odd"><td>status/feet</td>
<td>FootStateArray</td>
<td>The status and position of each foot</td>
</tr>
<tr class="row-even"><td>status/estop</td>
<td>EStopStateArray</td>
<td>The status of the eStop system</td>
</tr>
<tr class="row-odd"><td>status/wifi</td>
<td>WiFiState</td>
<td>Status of the wifi system</td>
</tr>
<tr class="row-even"><td>status/power_state</td>
<td>PowerState</td>
<td>General power information</td>
</tr>
<tr class="row-odd"><td>status/battery_states</td>
<td>BatteryStateArray</td>
<td>Information for the battery and all cells in the system</td>
</tr>
<tr class="row-even"><td>status/behavior_faults</td>
<td>BehaviorFaultState</td>
<td>A listing of behavior faults in the system</td>
</tr>
<tr class="row-odd"><td>status/system_faults</td>
<td>SystemFaultState</td>
<td>A listing of system faults in the system</td>
</tr>
<tr class="row-even"><td>status/feedback</td>
<td>Feedback</td>
<td>Feedback from the Spot robot</td>
</tr>
<tr class="row-odd"><td>status/mobility_params</td>
<td>MobilityParams</td>
<td>Describes the current state of the mobility parameters
defining the motion behaviour of the robot</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h2>
<p>These instructions are a minimum subset of instructions to get this driver working and do not contain all necessary
debugging steps.  Please refer to the <a class="reference external" href="https://github.com/boston-dynamics/spot-sdk/blob/master/docs/python/quickstart.md">Spot SDK Quickstart</a> for more detailed debugging steps.</p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="driver_configuration.html" class="btn btn-neutral float-left" title="Driver configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="arm_usage.html" class="btn btn-neutral float-right" title="Arm control" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Clearpath Robotics, 2023 Oxford Robotics Institute.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>